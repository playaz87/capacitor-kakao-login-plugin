{"version":3,"file":"plugin.cjs.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst KakaoLoginPlugin = registerPlugin('KakaoLoginPlugin', {\n    web: () => import('./web').then(m => new m.KakaoLoginPluginWeb()),\n});\nexport * from './definitions';\nexport { KakaoLoginPlugin };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nexport class KakaoLoginPluginWeb extends WebPlugin {\n    constructor() {\n        super(...arguments);\n        this.hasInit = false;\n        this.initForWeb = async (appkey) => {\n            var _a;\n            try {\n                await this.loadSDK();\n                this.testSDK();\n                if (!this.hasInit) {\n                    (_a = window.Kakao) === null || _a === void 0 ? void 0 : _a.init(appkey);\n                    this.hasInit = true;\n                }\n            }\n            catch (e) {\n                console.error('Error loading Kakao SDK', e);\n                return Promise.reject(e);\n            }\n        };\n        this.goLogin = () => {\n            this.testSDK();\n            return new Promise((resolve, reject) => {\n                try {\n                    window.Kakao.Auth.login({\n                        throughTalk: true,\n                        persistAccessToken: true,\n                        success: (response) => {\n                            this.response = response;\n                            const tokenExpire = new Date();\n                            tokenExpire.setSeconds(tokenExpire.getSeconds() + response.expires_in);\n                            const refreshTokenExpire = new Date();\n                            refreshTokenExpire.setSeconds(refreshTokenExpire.getSeconds() +\n                                response.refresh_token_expires_in);\n                            resolve({\n                                accessToken: response.access_token,\n                                expiredAt: tokenExpire.toISOString(),\n                                expiresIn: response.expires_in.toString(10),\n                                refreshToken: response.refresh_token,\n                                refreshTokenExpiresIn: response.refresh_token_expires_in.toString(10),\n                                tokenType: response.token_type,\n                                idToken: response.id_token,\n                                refreshTokenExpiredAt: refreshTokenExpire.toISOString(),\n                            });\n                        },\n                        fail: (error) => {\n                            console.error('Kakao Login Failed', error);\n                            reject(new Error('Kakao Login Failed'));\n                        },\n                    });\n                }\n                catch (e) {\n                    console.error('Error during Kakao login', e);\n                    reject(e);\n                }\n            });\n        };\n        this.loadSDK = () => {\n            return new Promise((resolve, reject) => {\n                if (document.getElementById('kakao-script')) {\n                    return resolve();\n                }\n                const script = document.createElement('script');\n                script.id = 'kakao-script';\n                script.type = 'text/javascript';\n                script.onload = resolve;\n                script.onerror = reject;\n                script.src = '//developers.kakao.com/sdk/js/kakao.min.js';\n                document.head.appendChild(script);\n            });\n        };\n    }\n    async goLogout() {\n        this.testSDK();\n        return new Promise((resolve, reject) => {\n            var _a;\n            const callBack = () => {\n                this.response = undefined;\n                resolve();\n            };\n            try {\n                (_a = window.Kakao) === null || _a === void 0 ? void 0 : _a.Auth.logout(callBack);\n            }\n            catch (e) {\n                console.error('Error logging out', e);\n                reject(e);\n            }\n        });\n    }\n    getUserInfo() {\n        this.testSDK();\n        if (!this.response) {\n            return Promise.reject('Not logged in.');\n        }\n        return new Promise((resolve, reject) => {\n            window.Kakao.API.request({\n                url: '/v2/user/me',\n                success: profile => {\n                    resolve({ value: profile });\n                },\n                fail: error => {\n                    console.error(error);\n                    reject(error);\n                },\n            });\n        });\n    }\n    sendLinkFeed(_options) {\n        throw this.unimplemented('Not implemented on web.');\n    }\n    talkInChannel(_options) {\n        throw this.unimplemented('Not implemented on web.');\n    }\n    testSDK() {\n        if (!window.Kakao) {\n            throw new Error('Kakao script not loaded. Call initForWeb for first');\n        }\n    }\n}\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin"],"mappings":"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"}