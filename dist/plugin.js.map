{"version":3,"file":"plugin.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst KakaoLoginPlugin = registerPlugin('KakaoLoginPlugin', {\n    web: () => import('./web').then(m => new m.KakaoLoginPluginWeb()),\n});\nexport * from './definitions';\nexport { KakaoLoginPlugin };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nexport class KakaoLoginPluginWeb extends WebPlugin {\n    constructor() {\n        super(...arguments);\n        this.hasInit = false;\n        this.initForWeb = async (appkey) => {\n            var _a;\n            try {\n                await this.loadSDK();\n                this.testSDK();\n                if (!this.hasInit) {\n                    (_a = window.Kakao) === null || _a === void 0 ? void 0 : _a.init(appkey);\n                    this.hasInit = true;\n                }\n            }\n            catch (e) {\n                console.error('Error loading Kakao SDK', e);\n                return Promise.reject(e);\n            }\n        };\n        this.goLogin = () => {\n            this.testSDK();\n            return new Promise((resolve, reject) => {\n                try {\n                    window.Kakao.Auth.login({\n                        throughTalk: true,\n                        persistAccessToken: true,\n                        success: (response) => {\n                            this.response = response;\n                            const tokenExpire = new Date();\n                            tokenExpire.setSeconds(tokenExpire.getSeconds() + response.expires_in);\n                            const refreshTokenExpire = new Date();\n                            refreshTokenExpire.setSeconds(refreshTokenExpire.getSeconds() +\n                                response.refresh_token_expires_in);\n                            resolve({\n                                accessToken: response.access_token,\n                                expiredAt: tokenExpire.toISOString(),\n                                expiresIn: response.expires_in.toString(10),\n                                refreshToken: response.refresh_token,\n                                refreshTokenExpiresIn: response.refresh_token_expires_in.toString(10),\n                                tokenType: response.token_type,\n                                idToken: response.id_token,\n                                refreshTokenExpiredAt: refreshTokenExpire.toISOString(),\n                            });\n                        },\n                        fail: (error) => {\n                            console.error('Kakao Login Failed', error);\n                            reject(new Error('Kakao Login Failed'));\n                        },\n                    });\n                }\n                catch (e) {\n                    console.error('Error during Kakao login', e);\n                    reject(e);\n                }\n            });\n        };\n        this.loadSDK = () => {\n            return new Promise((resolve, reject) => {\n                if (document.getElementById('kakao-script')) {\n                    return resolve();\n                }\n                const script = document.createElement('script');\n                script.id = 'kakao-script';\n                script.type = 'text/javascript';\n                script.onload = resolve;\n                script.onerror = reject;\n                script.src = '//developers.kakao.com/sdk/js/kakao.min.js';\n                document.head.appendChild(script);\n            });\n        };\n    }\n    async goLogout() {\n        this.testSDK();\n        return new Promise((resolve, reject) => {\n            var _a;\n            const callBack = () => {\n                this.response = undefined;\n                resolve();\n            };\n            try {\n                (_a = window.Kakao) === null || _a === void 0 ? void 0 : _a.Auth.logout(callBack);\n            }\n            catch (e) {\n                console.error('Error logging out', e);\n                reject(e);\n            }\n        });\n    }\n    getUserInfo() {\n        this.testSDK();\n        if (!this.response) {\n            return Promise.reject('Not logged in.');\n        }\n        return new Promise((resolve, reject) => {\n            window.Kakao.API.request({\n                url: '/v2/user/me',\n                success: profile => {\n                    resolve({ value: profile });\n                },\n                fail: error => {\n                    console.error(error);\n                    reject(error);\n                },\n            });\n        });\n    }\n    sendLinkFeed(_options) {\n        throw this.unimplemented('Not implemented on web.');\n    }\n    talkInChannel(_options) {\n        throw this.unimplemented('Not implemented on web.');\n    }\n    testSDK() {\n        if (!window.Kakao) {\n            throw new Error('Kakao script not loaded. Call initForWeb for first');\n        }\n    }\n}\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin"],"mappings":"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"}